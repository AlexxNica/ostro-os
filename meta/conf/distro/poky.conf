#@TYPE: Distribution#@NAME: Poky
#@DESCRIPTION: Distribution configuration for OpenedHand (Poky)

DISTRO = "poky"
DISTRO_NAME = "OpenedHand Linux (Poky)"
DISTRO_VERSION = "0.0-snapshot-${DATE}"

MAINTAINER = "OpenedHand <poky@openedhand.com>"

PACKAGE_CLASSES ?= "package_ipk"
INHERIT += " ${PACKAGE_CLASSES} debian multimachine poky devshell "
#INHERIT += " package_deb debian multimachine poky devshell "
# For some reason, this doesn't work
# TARGET_OS ?= "linux"
TARGET_VENDOR = "-poky"
TARGET_OS = "linux"
TARGET_FPU_arm ?= "soft"
TARGET_FPU_armeb ?= "soft"
IMAGE_ROOTFS_SIZE_ext2 ?= "131072"

#FEED_URIS += " \
#           upgrades##http://openzaurus.org/official/unstable/${DISTRO_VERSION}/upgrades/ \
#upgrades-${MACHINE}##http://openzaurus.org/official/unstable/${DISTRO_VERSION}/upgrades/${MACHINE} \
#            machine##http://openzaurus.org/official/unstable/${DISTRO_VERSION}/feed/machine/${MACHINE} \
#               base##http://openzaurus.org/official/unstable/${DISTRO_VERSION}/feed/base/ \
#               libs##http://openzaurus.org/official/unstable/${DISTRO_VERSION}/feed/libs/ \
#            console##http://openzaurus.org/official/unstable/${DISTRO_VERSION}/feed/console \
#              devel##http://openzaurus.org/official/unstable/${DISTRO_VERSION}/feed/devel"

ASSUME_PROVIDED += "virtual/arm-linux-gcc-2.95"
OEINCLUDELOGS = "yes"
KERNEL_CONSOLE = "ttyS0"
#DEBUG_OPTIMIZATION = "-O -g3"
#DEBUG_BUILD = "1"
#INHIBIT_PACKAGE_STRIP = "1"

POKYMODE ?= "eabi"
require conf/distro/include/poky-${POKYMODE}.inc

POKYLIBC ?= "glibc"
require conf/distro/include/poky-${POKYLIBC}.inc

#
# Preferred providers:
#
# Toolchain:
PREFERRED_PROVIDERS += " virtual/${TARGET_PREFIX}gcc-initial:gcc-cross-initial"
PREFERRED_PROVIDERS += " virtual/${TARGET_PREFIX}gcc:gcc-cross"
PREFERRED_PROVIDERS += " virtual/${TARGET_PREFIX}g++:gcc-cross"

# Virtuals:
PREFERRED_PROVIDER_virtual/db ?= "db"
PREFERRED_PROVIDER_virtual/db-native ?= "db-native"
PREFERRED_PROVIDER_virtual/xserver ?= xserver-kdrive
PREFERRED_PROVIDER_virtual/update-alternatives ?= update-alternatives-cworth
PREFERRED_PROVIDER_virtual/update-alternatives-native ?= update-alternatives-cworth-native
PREFERRED_PROVIDER_virtual/libx11 ?= "diet-x11"

# Others:
PREFERRED_PROVIDER_linux-libc-headers ?= "linux-libc-headers"
PREFERRED_PROVIDER_dbus-glib ?= "dbus-glib"
PREFERRED_PROVIDER_dbus-glib-native ?= "dbus-glib-native"
PREFERRED_PROVIDER_gconf ?= "gconf-dbus"
PREFERRED_PROVIDER_matchbox-panel ?= "matchbox-panel-2"


#
# CVS Dates to use:
#
SRCDATE_gconf-dbus ?= "20061219"
SRCDATE_contacts ?= "20070614"
SRCDATE_dates ?= "20070706"
SRCDATE_gtkhtml2 ?= "20060323"
SRCDATE_web ?= "20070529"
SRCDATE_eds-dbus ?= "20070704"
SRCDATE_minimo ?= "20070510"
SRCDATE_ipkg-utils-native ?= "20050930"
SRCDATE_ipkg-link-1 ?= "20050930"
SRCDATE_ipkg-utils ?= "20050930"
SRCDATE_ipkg-link ?= "20050930"
SRCDATE_matchbox-common ?= "20070607"
SRCDATE_matchbox-config-gtk ?= "20070723"
SRCDATE_matchbox-desktop ?= "20070716"
SRCDATE_matchbox-keyboard ?= "20070705"
SRCDATE_matchbox-panel ?= "20060727"
SRCDATE_matchbox-panel-manager ?= "20060612"
SRCDATE_matchbox-panel-2 ?= "20070715"
SRCDATE_matchbox-stroke ?= "20070417"
SRCDATE_matchbox-themes-extra ?= "20070417"
SRCDATE_matchbox-terminal ?= "20070714"
SRCDATE_matchbox-wm ?= "20070417"
SRCDATE_libmatchbox ?= "20070417"
SRCDATE_settings-daemon ?= "20070728"
SRCDATE_screenshot ?= "20070529"
SRCDATE_xcalibrateext ?= "20051101"
SRCDATE_libfakekey ?= "20051101"
SRCDATE_xcalibrate ?= "20060312"
SRCDATE_qemu ?= "20070613"
SRCDATE_qemu-native ?= "20070613"
SRCDATE_oprofile ?= "20070529"
SRCDATE_oprofileui ?= "20070529"
SRCDATE_zaurusd ?= "20070712"
SRCDATE_owl-video-widget ?= "20070529"
SRCDATE_psplash ?= "20070529"
SRCDATE_maemo-mapper-nohildon ?= "20061114"
SRCDATE_exmap-console = "20070529"
SRCDATE_gtk-sato-engine = "20070727"
SRCDATE_matchbox-theme-sato = "20070723"
SRCDATE_tasks = "20070711"
SRCDATE_sato-icon-theme = "20070630"
SRCDATE_matchbox-desktop-sato = "20070704"
SRCDATE_evince = "20070505"
SRCDATE_oh-puzzles = "20070714"
SRCDATE_libowl = "20070715"
SRCDATE_libxcalibrate = "20070607"
SRCDATE_calibrateproto = "20070607"
SRCDATE_hal-info = "20070513"
SRCDATE_gtk-theme-torturer = "20070529"
SRCDATE_libsyncml = "20070529"
SRCDATE_matchbox-applet-light = "20070529"
SRCDATE_fstests = "20070529"
SRCDATE_abiword ?= "20070130"
SRCDATE_xvideo-tests ?= "20070702"
SRCDATE_clutter ?= "20070725"

#
# Preferred Versions:
#
PREFERRED_VERSION_dates ?= "0.4.4+svn${SRCDATE}"
PREFERRED_VERSION_matchbox ?= "0.9.1"
PREFERRED_VERSION_matchbox-applet-inputmanager ?= "0.6"
PREFERRED_VERSION_matchbox-applet-startup-monitor ?= "0.1"
PREFERRED_VERSION_matchbox-common ?= "0.9.1+svn${SRCDATE}"
PREFERRED_VERSION_matchbox-config-gtk ?= "0.0+svn${SRCDATE}"
PREFERRED_VERSION_matchbox-desktop ?= "2.0+svn${SRCDATE}"
PREFERRED_VERSION_matchbox-keyboard ?= "0.0+svn${SRCDATE}"
PREFERRED_VERSION_matchbox-panel ?= "0.9.2+svn${SRCDATE}"
PREFERRED_VERSION_matchbox-stroke ?= "0.0+svn${SRCDATE}"
PREFERRED_VERSION_matchbox-themes-extra ?= "0.3+svn${SRCDATE}"
PREFERRED_VERSION_matchbox-wm ?= "1.2+svn${SRCDATE}"
PREFERRED_VERSION_libmatchbox ?= "1.9"

PREFERRED_VERSION_glib-2.0 ?= "2.10.3"
PREFERRED_VERSION_glib-2.0-native ?= "2.10.3"
PREFERRED_VERSION_atk ?= "1.10.3"
PREFERRED_VERSION_cairo ?= "1.2.4"
PREFERRED_VERSION_pango ?= "1.10.2"
PREFERRED_VERSION_gtk+ ?= "2.6.10"

PREFERRED_VERSION_dbus ?= "1.0.2"
PREFERRED_VERSION_dbus-native ?= "1.0.2"
PREFERRED_VERSION_dbus-glib ?= "0.74"
PREFERRED_VERSION_dbus-glib-native ?= "0.74"
PREFERRED_VERSION_gnome-vfs ?= "2.16.3"

PREFERRED_VERSION_dillo2 ?= "0.6.6"
PREFERRED_VERSION_evince ?= "0.9.0"
PREFERRED_VERSION_firefox ?= "1.0"
PREFERRED_VERSION_gaim ?= "2.0.0-cvs-mco1-20050904"
PREFERRED_VERSION_gtk2-theme-angelistic ?= "0.3"
PREFERRED_VERSION_keylaunch ?= "2.0.7"
PREFERRED_VERSION_librsvg ?= "2.11.1"
PREFERRED_VERSION_libgsm ?= "1.0.10"
PREFERRED_VERSION_libschedule ?= "0.15"
PREFERRED_VERSION_linphone-hh ?= "0.12.2.hh1"
PREFERRED_VERSION_linphone ?= "0.12.2"
PREFERRED_VERSION_minilite ?= "0.49"
PREFERRED_VERSION_minimo ?= "0.02+cvs${SRCDATE_minimo}"
PREFERRED_VERSION_poppler ?= "0.5.4"
PREFERRED_VERSION_rosetta ?= "0.0+cvs${SRCDATE}"
PREFERRED_VERSION_rxvt-unicode ?= "5.6"
PREFERRED_VERSION_xcursor-transparent-theme ?= "0.1.1"
PREFERRED_VERSION_xdemineur ?= "2.1.1"
PREFERRED_VERSION_xextensions ?= "1.0.1"


PREFERRED_VERSION_xmonobut ?= "0.4"
PREFERRED_VERSION_xprop ?= "0.0+cvs${SRCDATE}" 
PREFERRED_VERSION_xst ?= "0.15"
PREFERRED_VERSION_oprofile ?= "0.9.2+cvs${SRCDATE}"
PREFERRED_VERSION_elfutils ?= "0.89"
PREFERRED_VERSION_hal ?= "0.5.9"

require conf/distro/include/preferred-xorg-versions.inc

PCMCIA_MANAGER ?= "pcmciautils"

CVS_TARBALL_STASH += "http://www.o-hand.com/~richard/poky/sources/"

IMAGE_LINGUAS ?= "en-gb"

ENABLE_BINARY_LOCALE_GENERATION ?= "1"

DISTRO_FEATURES = "alsa bluetooth ext2 irda pcmcia usbgadget usbhost wifi"
DISTRO_FEATURES_cmx270 = "alsa bluetooth ext2 irda pcmcia usbgadget usbhost"

POKY_EXTRA_RDEPENDS = ""
POKY_EXTRA_RDEPENDS_qemuarm = "qemu-config"
POKY_EXTRA_RDEPENDS_qemux86 = "qemu-config"

DISTRO_EXTRA_RDEPENDS += "${POKY_EXTRA_RDEPENDS}"

IMAGE_FEATURES ?= ""

DISTRO_TASKS = "\
    task-poky-boot \
    task-base-extended \
    "

#
# Exclude known broken packages
#
# Needs scons/python-native
EXCLUDE_FROM_WORLD_pn-libsync = "1"
EXCLUDE_FROM_WORLD_pn-libopensync = "1"
EXCLUDE_FROM_WORLD_pn-libopensync-plugin-syncml = "1"
EXCLUDE_FROM_WORLD_pn-libopensync-plugin-evo2-sync = "1"
EXCLUDE_FROM_WORLD_pn-libopensync-plugin-irmc-sync = "1"
EXCLUDE_FROM_WORLD_pn-libopensync-plugin-file-sync = "1"
EXCLUDE_FROM_WORLD_pn-libopensync-plugin-syncml-plugin = "1"
EXCLUDE_FROM_WORLD_pn-libopensync-plugin-syncml-client-plugin = "1"
EXCLUDE_FROM_WORLD_pn-msynctool = "1"
# Needs glib 2.12
EXCLUDE_FROM_WORLD_pn-empathy = "1"
# Needs python
EXCLUDE_FROM_WORLD_pn-ipkg-utils = "1"
# Needs gcc 3.x
EXCLUDE_FROM_WORLD_pn-qemu = "1"
# only compatible with poky-bleeding (needs gtk+ 2.10)
EXCLUDE_FROM_WORLD_pn-gtk-engines = "1"
# compile failure
EXCLUDE_FROM_WORLD_pn-syncml-client = "1"
# temporary
EXCLUDE_FROM_WORLD_pn-lirc = "1"
EXCLUDE_FROM_WORLD_pn-lirc-modules = "1"
# clutter needs some kind of gl to build, not yet added
EXCLUDE_FROM_WORLD_pn-clutter = "1"
EXCLUDE_FROM_WORLD_pn-clutter-cairo = "1"
EXCLUDE_FROM_WORLD_pn-clutter-gst = "1"
EXCLUDE_FROM_WORLD_pn-aaina = "1"
EXCLUDE_FROM_WORLD_pn-table = "1"
EXCLUDE_FROM_WORLD_pn-task-poky-clutter = "1"
# needs gtk 2.10
EXCLUDE_FROM_WORLD_pn-ohm = "1"
