#!/usr/bin/python
import oefetch, sys
from oe import *

__oepath_found_it__ = 0

for s in getenv('OEPATH').split(":"):
	if os.access(os.path.join(s,'conf/oe.conf'), os.R_OK):
		__oepath_found_it__ = 1
		try:
			read_config(os.path.join(s,'conf/oe.conf'))	# Read configuration
		except IOError:
			pass

if __oepath_found_it__ == 0:
	fatal("error locating conf/oe.conf")

grabber = oefetch.FetchUrls()
urls = ["http://www.openzaurus.org/official/toolchain/old/cross-2.95.3.tar.bz2", "cvs://anoncvs:anonymous@cvs.handhelds.org/cvs;module=familiar/dist/ipkg;tag=V-99-84"]
print "Obtaining urls: %s" % urls

try:
	grabber.init(urls)
except oefetch.NoMethodError:
	fatal("No method for one or more urls in %s" % urls)

try:
	grabber.go()
except oefetch.MissingParameterError:
	fatal("Fetch failed due to missing parameters in the supplied urls")
except oefetch.FetchError:
	fatal("Fetch failed")
