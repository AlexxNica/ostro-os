#!/bin/sh

pkg="-"
mode="-"
type="f"
owner="0"
group="0"
src="-"
dest="-"
while [ $# -ge 1 ]; do
    arg=`eval echo $1`
    case $1 in
    -m|--mode)
        installcmd="$installcmd $1"
        shift || break
        mode="$1"
        ;;
    -o|--owner)
        installcmd="$installcmd $1"
        shift || break
        owner="$1"
        ;;
    -g|--group)
        installcmd="$installcmd $1"
        shift || break
        group="$1"
        ;;
    -d)
        type="d"
        ;;
    -*)
        ;;
    *)
        if [ "$#" -eq "1" ]; then
            dest="$arg"
        else
            srcs="$srcs $arg"
        fi
        ;;
    esac

    installcmd="$installcmd $1"
    shift || break
done

(
if [ -n "$srcs" ]; then
    for s in $srcs; do
        if (echo $dest|grep -q "/$"); then
            srcdest="$dest/`basename $s`"
        else
            srcdest="$dest"
        fi
        echo "$pkg	$s	$srcdest	$type	$mode	$owner	$group"
    done
else
    echo "$pkg	$src	$dest	$type	$mode	$owner	$group"
fi
) >> ${MANIFEST}

install $installcmd
exit 0
