#!/usr/bin/env python
# ex:ts=4:sw=4:sts=4:et
# -*- tab-width: 4; c-basic-offset: 4; indent-tabs-mode: nil -*-

import sys, oe, oe.manifest

mfile = sys.__stdin__
if len(sys.argv) == 2:
    mfile = file(sys.argv[1], "r")

d = oe.data.init()

manifest = oe.manifest.parse(mfile, d)

for func in ("do_stage", "do_install", "do_populate"):
    value = oe.manifest.emit(func, manifest, d)
    if value:
        oe.data.setVar(func, value, d)
    oe.data.setVarFlag(func, "func", 1, d)
    oe.data.emit_var(func, sys.__stdout__, d)
    sys.__stdout__.write("\n")
